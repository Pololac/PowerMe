# ==============================================
# Configuration TESTS
# ==============================================

spring:
  # JPA (recréé à chaque test) avec TestContainers
  jpa:
    hibernate:
      ddl-auto: create-drop
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.H2Dialect
        format_sql: true
        use_sql_comments: true

  # Désactivation de flyway
  flyway:
    enabled: false

  # Mail
  mail:
    host: test
    port: 1025
    username: test
    password: test
    properties:
      mail:
        smtp:
          auth: false
          starttls:
            enable: false

# Port aléatoire (évite les conflits)
server:
  port: 0
  error:
    include-message: always       # voir les messages d'erreurs (précieux en test)
    include-binding-errors: always

# Logs pour debug
logging:
  level:
    root: WARN                    # warnings et erreurs globales
    com.powerme: INFO             # tes classes : infos utiles
    org.springframework.web: INFO # infos sur les requêtes HTTP
    org.springframework.security: WARN # évite le spam de Spring Security
    org.hibernate.SQL: WARN       # désactive le SQL détaillé
    org.hibernate.type: ERROR     # aucune trace des types hibernate (super bruyant)
  pattern:
    console: "%d{HH:mm:ss.SSS} %-5level %logger{36} - %msg%n"
